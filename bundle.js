(()=>{"use strict";var e={103:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPlaceholderAuthorBranchLabel=function(e){const t=`who-is-in-branch-${e}`;let n=document.getElementById(t);if(n)return n;n=document.createElement("a"),n.id=t,n.className="flex-shrink-0 flex-self-start flex-md-self-center",n.style.marginLeft="8px",n.style.textDecoration="none";const i=document.createElement("span");i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="space-between",i.style.flexDirection="row",i.title="Loading...",i.className="js-flywheel-draft-pr-step State",i.appendChild(function(){const e=document.createElement("div");e.style.border="2px solid white",e.style.borderTop="2px solid rgb(110, 119, 129)",e.style.borderRadius="50%",e.style.width="16px",e.style.height="16px",e.style.animation="spin 2s linear infinite";const t=document.createElement("style");return t.textContent="\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n  ",document.head.appendChild(t),e}());const r=document.createElement("div");return r.textContent=`${(0,o.capitaliseFirstLetter)(e)}`,r.style.marginLeft="8px",i.appendChild(r),n.appendChild(i),n},t.createAuthorBranchLabel=function(e,t,n){const s=`who-is-in-branch-${t}`;let a=document.getElementById(s);a&&a.remove(),a=document.createElement("a"),a.id=s,a.className="flex-shrink-0 flex-self-start flex-md-self-center",a.style.marginLeft="8px",a.style.textDecoration="none";const[l,c,u]=e?e===n?["merged",`You are in ${t}`,i()]:["closed",`${e} in ${t}`,r()]:["open",`No one in ${t}`,i()],d=document.createElement("span");d.style.display="flex",d.style.alignItems="center",d.style.justifyContent="space-between",d.style.flexDirection="row",d.title=c,d.className=`js-flywheel-draft-pr-step State State--${l}`,d.appendChild(u);const p=document.createElement("div");return p.textContent=`${(0,o.capitaliseFirstLetter)(t)}`,p.style.marginLeft="8px",d.appendChild(p),a.appendChild(d),a};const o=n(140);function i(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("aria-hidden","true"),e.setAttribute("height","16"),e.setAttribute("viewBox","0 0 16 16"),e.setAttribute("version","1.1"),e.setAttribute("width","16"),e.setAttribute("data-view-component","true"),e.setAttribute("class","octicon octicon-git-compare");const t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d","M9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM6 12v-1.646a.25.25 0 0 1 .427-.177l2.396 2.396a.25.25 0 0 1 0 .354l-2.396 2.396A.25.25 0 0 1 6 15.146V13.5H5A2.5 2.5 0 0 1 2.5 11V5.372a2.25 2.25 0 1 1 1.5 0V11a1 1 0 0 0 1 1ZM4 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0ZM12.75 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"),e.appendChild(t),e}function r(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("height","16"),e.setAttribute("class","octicon octicon-git-pull-request-closed"),e.setAttribute("viewBox","0 0 16 16"),e.setAttribute("version","1.1"),e.setAttribute("width","16"),e.setAttribute("aria-hidden","true");const t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d","M3.25 1A2.25 2.25 0 0 1 4 5.372v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.251 2.251 0 0 1 3.25 1Zm9.5 5.5a.75.75 0 0 1 .75.75v3.378a2.251 2.251 0 1 1-1.5 0V7.25a.75.75 0 0 1 .75-.75Zm-2.03-5.273a.75.75 0 0 1 1.06 0l.97.97.97-.97a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.97.97.97.97a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-.97-.97-.97.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l.97-.97-.97-.97a.75.75 0 0 1 0-1.06ZM2.5 3.25a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0ZM3.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm9.5 0a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"),e.appendChild(t),e}},126:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.observeValueChange=void 0,t.observeValueChange=e=>{let t=e;return e=>{const n=t!==e;return t=e,n}}},140:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countOccurrences=t.executeWithCooldown=void 0,t.log=o,t.error=function(...e){e=[n,...e],console.error.apply(console,e)},t.capitaliseFirstLetter=function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""};const n="@gwib";function o(...e){e=[n,...e],console.log.apply(console,e)}t.executeWithCooldown=(()=>{const e={},t={};return async(n,i,r)=>{const s=(new Date).getTime(),a=e[n],l=t[n],c=async()=>{o("execute with cooldown",n),e[n]=s+6e7,await i(),e[n]=s};if(s-a<r){if(!l){const e=r-(s-a);t[n]=setTimeout((async()=>{t[n]=null,c()}),e)}}else c()}})(),t.countOccurrences=e=>{const t={};for(let n=0;n<e.length;n++){const o=e[n];t[o]?t[o]++:t[o]=1}return t}},149:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countOccurrences=t.executeWithCooldown=void 0,t.log=o,t.error=function(...e){e=[n,...e],console.error.apply(console,e)},t.capitaliseFirstLetter=function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""};const n="@gwsb";function o(...e){e=[n,...e],console.log.apply(console,e)}t.executeWithCooldown=(()=>{const e={},t={};return async(n,i,r)=>{const s=(new Date).getTime(),a=e[n],l=t[n],c=async()=>{o("execute with cooldown",n),e[n]=s+6e7,await i(),e[n]=s};if(s-a<r){if(!l){const e=r-(s-a);t[n]=setTimeout((async()=>{t[n]=null,c()}),e)}}else c()}})(),t.countOccurrences=e=>{const t={};for(let n=0;n<e.length;n++){const o=e[n];t[o]?t[o]++:t[o]=1}return t}},187:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.executeWithCooldown=t.UPDATE_PR_DETAILS_CONTENT_ACTION=t.UPDATE_PR_DETAILS_BACKGROUND_ACTION=void 0,t.log=function(...e){e=[n,...e],console.log.apply(console,e)},t.error=function(...e){e=[n,...e],console.error.apply(console,e)};const n="@gprc";t.UPDATE_PR_DETAILS_BACKGROUND_ACTION="UPDATE_PR_DETAILS_BACKGROUND_ACTION",t.UPDATE_PR_DETAILS_CONTENT_ACTION="UPDATE_PR_DETAILS_CONTENT_ACTION",t.executeWithCooldown=(()=>{const e={},t={};return async(n,o,i)=>{const r=(new Date).getTime(),s=e[n],a=t[n],l=async()=>{e[n]=r+6e7,await o(),e[n]=r};if(r-s<i){if(!a){const e=i-(r-s);t[n]=setTimeout((async()=>{t[n]=null,l()}),e)}}else l()}})()},244:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(...e){e=[n,...e],console.log.apply(console,e)},t.error=function(...e){e=[n,...e],console.error.apply(console,e)};const n="@gcsr"},256:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialisePullRequestCreation=void 0;const o=n(334),i=n(289),r=n(187),s=[{currentBranch:["staging"],nextBranch:["main","master"],nextBranchAlias:"Production"},{currentBranch:["dev","development"],nextBranch:["staging"],nextBranchAlias:"Staging"}];async function a(){if(document.querySelector(".sidebar-clone-pr"))return!1;const e=document.querySelector("#partial-discussion-sidebar");if(!e)return!1;const t=(0,o.getPrBranchElements)();if(!t[0]||!t[1])return!1;const n=(t[0].textContent??"").trim(),a=(t[1].textContent??"").trim();(0,r.log)({type:"pr branches",from:a,to:n});const l=await async function(e){for(const t of s)if(t.currentBranch.includes(e))for(const e of t.nextBranch)if(await(0,i.doesBranchExist)(e))return e;return null}(n),c=document.createElement("div");c.setAttribute("id","sidebar-clone-pr"),c.setAttribute("class","discussion-sidebar-item sidebar-clone-pr"),c.style.paddingTop="0px",e.insertBefore(c,e.firstChild);const{title:u,description:d}=await(0,i.getPrDetails)();if(l){(0,r.log)({nextToBranch:l});const e=s.find((e=>e.nextBranch.includes(l)));if(!e)return(0,r.error)("Universe Branch Config configured incorrectly!"),!1;const t=["STAGING","DEVELOPMENT","DEV"],i=(0,o.replaceFirstMatchingWord)(u,e.nextBranchAlias.toUpperCase(),t);(0,r.log)("title formatting",{title:u,newTitle:i});const a=(0,o.createButton)(`${(0,o.truncateWithEllipses)(l)} from ${(0,o.truncateWithEllipses)(n)}`,(0,o.buildCreatePrOnClick)(n,l,i,d),(0,o.svgNew)());c.appendChild(a)}const p=(0,o.createButton)(`${(0,o.truncateWithEllipses)(n)} from ${(0,o.truncateWithEllipses)(a)}`,(0,o.buildCreatePrOnClick)(a,n,u,d),(0,o.svgCopy)());c.appendChild(p)}chrome.runtime.onMessage.addListener(((e,t,n)=>{e.action===r.UPDATE_PR_DETAILS_CONTENT_ACTION&&((0,r.log)("UPDATE_PR_DETAILS_CONTENT_ACTION",{title:e.title,description:e.description}),((e,t)=>{const n=document.querySelector("#pull_request_title"),o=document.querySelector("#pull_request_body"),i=document.querySelector(".hx_create-pr-button");new MutationObserver((async(r,s)=>{if(n&&o&&i){n.value=e,o.value=t;const i=new Event("input",{bubbles:!0});n.dispatchEvent(i),o.dispatchEvent(i),s.disconnect()}})).observe(document.body,{childList:!0,subtree:!0})})(e.title,e.description))})),t.initialisePullRequestCreation=()=>{(0,r.log)("initialising 'pull request creation'"),new MutationObserver((async(e,t)=>{const n=window.location.href;new RegExp("^https://github.com/.+/.+/pull/[0-9]+$").test(n)&&i.GITHUB_TOKEN&&(0,r.executeWithCooldown)("createPullRequestSidebarSection",a,500)})).observe(document.body,{childList:!0,subtree:!0})}},289:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GITHUB_TOKEN=void 0,t.getPrDetails=async function(){const[e,n,o,i,r]=window.location.pathname.split("/"),s=await fetch(`https://api.github.com/repos/${n}/${o}/pulls/${r}`,{headers:{Authorization:`token ${t.GITHUB_TOKEN}`,Accept:"application/vnd.github.v3+json"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();return{title:a.title,description:a.body}},t.setPrDescription=async function(e){const[n,o,i,r,s]=window.location.pathname.split("/"),a=`https://api.github.com/repos/${o}/${i}/pulls/${s}`,l=await fetch(a,{method:"PATCH",headers:{Authorization:`token ${t.GITHUB_TOKEN}`,Accept:"application/vnd.github.v3+json"},body:JSON.stringify({body:e})});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()},t.doesBranchExist=async function(e){const n=`https://api.github.com/repos/${window.location.pathname.split("/").slice(1,3).join("/")}/branches/${e}`;try{return!!(await fetch(n,{headers:{Authorization:`token ${t.GITHUB_TOKEN}`}})).ok||((0,o.error)(`Branch ${e} not found`),!1)}catch(e){return!1}};const o=n(187);t.GITHUB_TOKEN="",chrome.storage.sync.get(["GITHUB_TOKEN"],(e=>{e.GITHUB_TOKEN?t.GITHUB_TOKEN=e.GITHUB_TOKEN:(0,o.error)("GITHUB_TOKEN not set")}))},318:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ATLASSIAN_SUBDOMAIN=void 0;const o=n(555);t.ATLASSIAN_SUBDOMAIN="",chrome.storage.sync.get(["atlassian-subdomain"],(e=>{e["atlassian-subdomain"]?t.ATLASSIAN_SUBDOMAIN=e["atlassian-subdomain"]:(0,o.error)("atlassian-subdomain not set")}))},334:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPrBranchElements=function(){return document.querySelectorAll(".commit-ref.css-truncate.user-select-contain.expandable .css-truncate-target")},t.buildCreatePrOnClick=function(e,t,n,i){return async()=>{const r=`https://github.com/${window.location.pathname.split("/").slice(1,3).join("/")}/compare/${t}...${e}?expand=1`;chrome.runtime.sendMessage({action:o.UPDATE_PR_DETAILS_BACKGROUND_ACTION,url:r,title:n,description:i})}},t.truncateWithEllipses=function(e,t=12){if(e.length>t){let n=e.substring(0,t),o=n.lastIndexOf(" "),i=n.lastIndexOf("_"),r=n.lastIndexOf("-"),s=Math.max(o,i,r);return-1===s&&(s=t),e.substring(0,s)+"..."}return e},t.svgCopy=function(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"height","16"),e.setAttributeNS(null,"width","16"),e.setAttributeNS(null,"viewBox","0 0 512 512");const t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttributeNS(null,"d","M64 464H288c8.8 0 16-7.2 16-16V384h48v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64h64v48H64c-8.8 0-16 7.2-16 16V448c0 8.8 7.2 16 16 16zM224 304H448c8.8 0 16-7.2 16-16V64c0-8.8-7.2-16-16-16H224c-8.8 0-16 7.2-16 16V288c0 8.8 7.2 16 16 16zm-64-16V64c0-35.3 28.7-64 64-64H448c35.3 0 64 28.7 64 64V288c0 35.3-28.7 64-64 64H224c-35.3 0-64-28.7-64-64z"),e.appendChild(t),e},t.svgNew=function(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"height","16"),e.setAttributeNS(null,"width","16"),e.setAttributeNS(null,"viewBox","0 0 512 512");const t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttributeNS(null,"d","M305.8 2.1C314.4 5.9 320 14.5 320 24V64h16c70.7 0 128 57.3 128 128V358.7c28.3 12.3 48 40.5 48 73.3c0 44.2-35.8 80-80 80s-80-35.8-80-80c0-32.8 19.7-61 48-73.3V192c0-35.3-28.7-64-64-64H320v40c0 9.5-5.6 18.1-14.2 21.9s-18.8 2.3-25.8-4.1l-80-72c-5.1-4.6-7.9-11-7.9-17.8s2.9-13.3 7.9-17.8l80-72c7-6.3 17.2-7.9 25.8-4.1zM104 80A24 24 0 1 0 56 80a24 24 0 1 0 48 0zm8 73.3V358.7c28.3 12.3 48 40.5 48 73.3c0 44.2-35.8 80-80 80s-80-35.8-80-80c0-32.8 19.7-61 48-73.3V153.3C19.7 141 0 112.8 0 80C0 35.8 35.8 0 80 0s80 35.8 80 80c0 32.8-19.7 61-48 73.3zM104 432a24 24 0 1 0 -48 0 24 24 0 1 0 48 0zm328 24a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"),e.appendChild(t),e},t.createButton=function(e,t,n){const o=document.createElement("button");o.setAttribute("class","Button--secondary Button--small Button Button--fullWidth"),o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.marginTop="8px",o.onclick=t;const i=document.createElement("p");return i.textContent=e,i.style.margin="0px 0px 0px 8px",o.appendChild(n),o.appendChild(i),o},t.replaceFirstMatchingWord=function(e,t,n){for(const o of n){const n=new RegExp(o,"gi"),i=e.replace(n,t);if(i!==e)return i}return e};const o=n(187)},367:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.observeValueChange=void 0,t.svgPlus=function(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"height","24"),e.setAttributeNS(null,"width","24"),e.setAttributeNS(null,"viewBox","0 0 512 512"),e.setAttribute("class","hoverable-svg");const t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttributeNS(null,"d","M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM200 344V280H136c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H248v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"),t.setAttributeNS(null,"fill","#737d83"),e.appendChild(t);const n=document.createElement("style");return n.textContent="\n     .hoverable-svg:hover path {\n       fill: #ff87ee;\n     }\n   ",document.head.append(n),e},t.observeValueChange=e=>{let t=e;return e=>{const n=t!==e;return t=e,n}}},408:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseDefaultPullRequestFilters=t.PULL_REQUEST_FILTER_URL_SEARCH_PARAMS=void 0;const o=n(126),i=n(851);t.PULL_REQUEST_FILTER_URL_SEARCH_PARAMS="",chrome.storage.sync.get(["pull-request-filter-url-search-params"],(e=>{e["pull-request-filter-url-search-params"]?t.PULL_REQUEST_FILTER_URL_SEARCH_PARAMS=e["pull-request-filter-url-search-params"]:t.PULL_REQUEST_FILTER_URL_SEARCH_PARAMS=""})),t.initialiseDefaultPullRequestFilters=()=>{(0,i.log)("initialising 'default pull request filters'");const e=(0,o.observeValueChange)(null);new MutationObserver((async(n,o)=>{e(window.location.href)&&(()=>{const e=document.querySelector("#pull-requests-tab");if(e){const n=new URL(e.href);n.search=t.PULL_REQUEST_FILTER_URL_SEARCH_PARAMS,e.href=n.href}})()})).observe(document.body,{childList:!0,subtree:!0})}},411:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GITHUB_TOKEN=void 0,t.doesBranchExist=async function(e){const n=`https://api.github.com/repos/${window.location.pathname.split("/").slice(1,3).join("/")}/branches/${e}`;try{return!!(await fetch(n,{headers:{Authorization:`token ${t.GITHUB_TOKEN}`}})).ok}catch(e){return!1}};const o=n(149);t.GITHUB_TOKEN="",chrome.storage.sync.get(["GITHUB_TOKEN"],(e=>{e.GITHUB_TOKEN?t.GITHUB_TOKEN=e.GITHUB_TOKEN:(0,o.error)("GITHUB_TOKEN not set")}))},463:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseWhoIsInTheBranch=void 0;const o=n(103),i=n(848),r=n(140);async function s(e){for(const t of e)if(await(0,i.doesBranchExist)(t))return t;return null}t.initialiseWhoIsInTheBranch=()=>{(0,r.log)("initialising 'who is in the branch'");let e=null,t=null;new MutationObserver((async(n,a)=>{const l=window.location.href,c=new RegExp("^https://github.com/.+/.+"),u=window.location.pathname.split("/")[2];c.test(l)&&i.GITHUB_TOKEN&&e!==u&&((0,r.log)("repository",e,u),t=window.location.pathname.split("/")[1],e=u,(0,r.executeWithCooldown)("createWhoIsInBranchPanel",(()=>async function(e,t){const n=document.querySelector('nav[role="navigation"]');if(!n)return!1;n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="space-between",n.style.flexDirection="row";let a=document.getElementById("who-is-in-branch-wrapper");a||(a=document.createElement("div"),a.id="who-is-in-branch-wrapper",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="flex-end",a.style.flexDirection="row",n.appendChild(a));const l={development:await s(["development","dev"]),staging:"staging",production:await s(["main","master"])};if((0,r.log)("branch names",l),null!==l.development&&null!==l.staging&&null!==l.production){a.appendChild((0,o.createPlaceholderAuthorBranchLabel)("development")),a.appendChild((0,o.createPlaceholderAuthorBranchLabel)("staging"));const n=await(0,i.getUser)(),s={development:await(0,i.whoIfAnyoneIsInBranch)(l.development,l.staging),staging:await(0,i.whoIfAnyoneIsInBranch)(l.staging,l.production)};return(0,r.log)("authors",s),Object.entries(s).forEach((([i,r])=>{const s=l[i],c=l["development"===i?"staging":"production"],u=(0,o.createAuthorBranchLabel)(r,i,n);u.href=`https://github.com/${e}/${t}/compare/${c}...${s}`,a.appendChild(u)})),!0}return!1}(t,e)),500))})).observe(document.body,{childList:!0,subtree:!0})}},548:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(...e){e=[n,...e],console.log.apply(console,e)},t.error=function(...e){e=[n,...e],console.error.apply(console,e)};const n="@ghcc"},555:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.executeWithCooldown=void 0,t.log=o,t.error=function(...e){e=[n,...e],console.error.apply(console,e)};const n="@gpjl";function o(...e){e=[n,...e],console.log.apply(console,e)}t.executeWithCooldown=(()=>{const e={},t={};return async(n,i,r)=>{const s=(new Date).getTime(),a=e[n],l=t[n],c=async()=>{o("execute with cooldown",n),e[n]=s+6e7,await i(),e[n]=s};if(s-a<r){if(!l){const e=r-(s-a);t[n]=setTimeout((async()=>{t[n]=null,c()}),e)}}else c()}})()},569:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GITHUB_TOKEN=void 0,t.getPrDetails=async function(){const[e,n,o,i,r]=window.location.pathname.split("/"),s=await fetch(`https://api.github.com/repos/${n}/${o}/pulls/${r}`,{headers:{Authorization:`token ${t.GITHUB_TOKEN}`,Accept:"application/vnd.github.v3+json"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();return{title:a.title,description:a.body}},t.setPrDescription=async function(e){const[n,o,i,r,s]=window.location.pathname.split("/"),a=`https://api.github.com/repos/${o}/${i}/pulls/${s}`,l=await fetch(a,{method:"PATCH",headers:{Authorization:`token ${t.GITHUB_TOKEN}`,Accept:"application/vnd.github.v3+json"},body:JSON.stringify({body:e})});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()};const o=n(555);t.GITHUB_TOKEN="",chrome.storage.sync.get(["GITHUB_TOKEN"],(e=>{e.GITHUB_TOKEN?t.GITHUB_TOKEN=e.GITHUB_TOKEN:(0,o.error)("GITHUB_TOKEN not set")}))},655:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addCommitCompareFunctionality=t.isOnPullRequestConversationTab=t.observeValueChange=t.createState=void 0;const o=n(548);t.createState=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},t.observeValueChange=e=>{let t=e;return e=>{const n=t!==e;return t=e,n}},t.isOnPullRequestConversationTab=()=>{const e=window.location.href;return/https:\/\/github\.com\/[^\/]+\/[^\/]+\/pull\/\d+$/.test(e)};const i=(e,t)=>`${window.location.href.split("/").slice(0,7).join("/")}/files/${e}..${t}`,r=(e,t,n)=>{t.addEventListener("click",(function(t){t.preventDefault();const r=this.getAttribute("href");let s;const a=e();a?(s=a.index<n.index?i(a.name,n.name):i(n.name,a.name),(0,o.log)("compare commits link clicked",s)):s=r,t.ctrlKey?window.open(s,"_blank"):window.location.href=s}))};t.addCommitCompareFunctionality=e=>{(()=>{if(!document.getElementById("badgeStyles")){(0,o.log)("adding badge styles to document head");const e=document.createElement("style");e.id="badge-styles",e.innerHTML='\n          .badge:before {\n            position: absolute;\n            top: -6px;\n            left: 2px;\n            content: "";\n            display: block;\n            width: 28px;\n            height: 28px;\n            background-color: var(--timelineBadge-bgColor, var(--color-timeline-badge-bg));\n            z-index: -1;\n            border-radius: 50%;\n            box-sizing: border-box;\n            border: var(--borderWidth-thick, max(2px, 0.125rem)) solid var(--bgColor-default, var(--color-canvas-default))\n            transition: background-color 0.3s ease;\n          }\n        \n          .badge:hover:before {\n            background-color: white;\n            border: 4px solid var(--timelineBadge-bgColor, var(--color-timeline-badge-bg));\n          }\n    \n          .badge.badge-clicked:before {\n            background-color: #ff87ee;\n          }\n    \n          .badge.badge-clicked:hover:before {\n            background-color: white;\n            border: 4px solid #ff87ee;\n          }\n    \n          .badge.badge-clicked:not(:hover) > svg {\n            color: var(--fgColor-onEmphasis, var(--color-fg-on-emphasis)) !important;\n          }\n        ',document.head.appendChild(e)}})();const t=Array.from(document.querySelectorAll(".TimelineItem"));(0,o.log)("timeline elements",t.length,{timelineElements:t}),t.forEach(((t,n)=>{const i=t.querySelectorAll('a[href^="/"][href*="/pull/"][href*="/commits/"]'),s=t.querySelector(".TimelineItem-badge");if(i[1]?.textContent&&s){const t={name:i[1].textContent,index:n};((e,t,n)=>{t.classList.add("badge"),t.onclick=()=>{t.classList.contains("badge-clicked")?(t.classList.remove("badge-clicked"),e(null),(0,o.log)("cleared selected commit")):(document.querySelectorAll(".badge-clicked").forEach((e=>{e.classList.remove("badge-clicked")})),t.classList.add("badge-clicked"),e(n),(0,o.log)("set selected commit",n))}})(e.set,s,t);for(const n of i)r(e.get,n,t)}}))}},680:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialisePullRequestJiraLinking=void 0;const o=n(569),i=n(318),r=n(555);async function s(){const e=document.querySelector(".timeline-comment-header");if(!e)return!1;let{title:t,description:n}=await(0,o.getPrDetails)();n||(n="");const s=t.match(/\b([A-Za-z]+-\d+)\b/gi);if(!s)return!1;const a=s.map((e=>e.toUpperCase().trim().replace(/^[\[\]]+|[\[\]]+$/g,""))),l=`https://${i.ATLASSIAN_SUBDOMAIN}.atlassian.net`;(0,r.log)("pr details",{title:t,description:n},"tickets",a);const c=function(){const e=document.querySelector("#jira-link-button");if(e)return e;const t=document.createElement("button");t.id="jira-link-button",t.style.display="flex",t.style.flexDirection="row",t.style.justifyContent="center",t.style.alignItems="center",t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.borderRadius="4px",t.style.padding="2px 4px";const n=document.createElement("img");return n.setAttribute("src",chrome.runtime.getURL("jira.svg")),n.style.width="18px",n.style.height="18px",t.appendChild(n),t}();e.insertBefore(c,e.children[1]);const u=n.includes(l+"/browse")||n.includes(l+"/jira"),d=a.map((e=>`${l}/browse/${e}`)),p=document.querySelector("#jira-link-label");if(u)c.onclick=function(){(0,r.log)("going to jira ticket(s)"),d.map((e=>window.open(e,"_blank")))},c.style.background="rgba(255,255,255,0)",p&&p.remove();else{if(!p){const e=document.createElement("div");e.id="jira-link-label",e.textContent="Link to Jira",e.style.marginLeft="4px",c.appendChild(e)}c.style.background="rgba(255,255,255,0.5)",c.onclick=async function(){(0,r.log)("adding link(s) to jira"),await(0,o.setPrDescription)([...d,n].join("\n\n")),c.remove()}}}t.initialisePullRequestJiraLinking=()=>{(0,r.log)("initialising 'pull request jira linking'"),new MutationObserver((async(e,t)=>{(()=>{let e=window.location.pathname;return/^\/[^\/]+\/[^\/]+\/pull\/[^\/]+\/?$/.test(e)})()&&o.GITHUB_TOKEN&&i.ATLASSIAN_SUBDOMAIN&&(0,r.executeWithCooldown)("createJiraLinkComponents",s,500)})).observe(document.body,{childList:!0,subtree:!0})}},706:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseWarnSkipBranch=void 0;const o=n(888),i=n(411),r=n(149);async function s(e){for(const t of e)if(await(0,i.doesBranchExist)(t))return t;return null}t.initialiseWarnSkipBranch=()=>{(0,r.log)("initialising 'warn of skipped branch'");let e=null,t=null;new MutationObserver((async(n,a)=>{const l=window.location.href,c=new RegExp("^https://github.com/.+/.+/pull/\\d+"),u=window.location.pathname.split("/")[2],d=Number(window.location.pathname.split("/")[4]);c.test(l)&&i.GITHUB_TOKEN&&e!==u&&t!==d&&((0,r.log)("repository",e,u),e=u,t=d,(0,r.log)("pull request number",t),(0,r.executeWithCooldown)("createWarnSkipBranchPanel",(()=>async function(){const e={development:await s(["development","dev"]),staging:"staging",production:await s(["main","master"])};if((0,r.log)("branch names",e),null!==e.development&&null!==e.staging&&null!==e.production){(0,r.log)("expected universes exist");const t=document.getElementById("partial-discussion-header");if(!t)return(0,r.log)("parent element not found"),!0;const n=t.querySelectorAll("span.css-truncate-target:not([class*=' '])");let i=null,s=null,a=0;for(const e of n)null===i?i=e.textContent:null===s&&e.textContent!==i&&(s=e.textContent),a+=1;if((0,r.log)("branches [to, from]",i,s),null===i||null===s)return!0;let l=!1;s===e.development&&i===e.staging?((0,r.log)("development to staging"),l=!0):s===e.staging&&i===e.production?((0,r.log)("staging to production"),l=!0):[e.staging,e.production].includes(s)||i!==e.development?(0,r.log)("branch transition not recognised"):((0,r.log)("feature to dev"),l=!0);const c=t.querySelector("svg.octicon.octicon-copy");if(null===c)return(0,r.log)("neighbour element not found"),!0;const u=(0,o.CreateBranchTransitionElement)(l);return c.parentElement?.parentElement?.parentElement?.appendChild(u),!0}return!1}()),500))})).observe(document.body,{childList:!0,subtree:!0})}},815:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseFilesChangedSidebarResize=void 0;const o=n(863),i=n(367),r=n(244);t.initialiseFilesChangedSidebarResize=()=>{(0,r.log)("initialising 'files changed sidebar resize'");const e=(0,i.observeValueChange)(null);new MutationObserver((async(t,n)=>{e(window.location.href)&&(()=>{const e=document.querySelector("#files_bucket .subnav-search"),t=document.querySelector("#files_bucket .subnav-search-icon"),n=document.querySelector("#files_bucket .Layout");let i=document.getElementById("subnav-search-resizer");if(t&&n&&e&&!i){t.style.top="unset",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",i=(0,o.svgPlus)(),i.style.margin="8px",i.style.marginRight="0px",i.id="subnav-search-resizer",e.appendChild(i);const r=n.style.getPropertyValue("--Layout-sidebar-width");i.onclick=()=>{if(n){const e=n.style.getPropertyValue("--Layout-sidebar-width");let t="";r===e&&(t="512px"),n.style.setProperty("--Layout-sidebar-width",t)}}}})()})).observe(document.body,{childList:!0,subtree:!0})}},848:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GITHUB_TOKEN=void 0,t.getPrDetails=async function(){const[e,n,o,i,r]=window.location.pathname.split("/"),s=await fetch(`https://api.github.com/repos/${n}/${o}/pulls/${r}`,{headers:{Authorization:`token ${t.GITHUB_TOKEN}`,Accept:"application/vnd.github.v3+json"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();return{title:a.title,description:a.body}},t.setPrDescription=async function(e){const[n,o,i,r,s]=window.location.pathname.split("/"),a=`https://api.github.com/repos/${o}/${i}/pulls/${s}`,l=await fetch(a,{method:"PATCH",headers:{Authorization:`token ${t.GITHUB_TOKEN}`,Accept:"application/vnd.github.v3+json"},body:JSON.stringify({body:e})});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()},t.doesBranchExist=async function(e){const n=`https://api.github.com/repos/${window.location.pathname.split("/").slice(1,3).join("/")}/branches/${e}`;try{return!!(await fetch(n,{headers:{Authorization:`token ${t.GITHUB_TOKEN}`}})).ok}catch(e){return!1}},t.whoIfAnyoneIsInBranch=async function(e,n){const i=`https://api.github.com/repos/${window.location.pathname.split("/").slice(1,3).join("/")}/compare/${n}...${e}`;try{const r=await fetch(i,{headers:{Authorization:`token ${t.GITHUB_TOKEN}`}});if(!r.ok)return(0,o.error)(`Failed to compare branches ${e} and ${n}`),null;const s=await r.json();return"identical"===s.status?((0,o.log)("No differences between the two branches."),null):s.commits.at(-1).author.login}catch(e){return null}},t.getUser=async function(){try{const e=await fetch("https://api.github.com/user",{headers:{Authorization:`token ${t.GITHUB_TOKEN}`}});return e.ok?(await e.json()).login:((0,o.error)("Failed to get user"),null)}catch(e){return null}};const o=n(140);t.GITHUB_TOKEN="",chrome.storage.sync.get(["GITHUB_TOKEN"],(e=>{e.GITHUB_TOKEN?t.GITHUB_TOKEN=e.GITHUB_TOKEN:(0,o.error)("GITHUB_TOKEN not set")}))},851:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(...e){e=[n,...e],console.log.apply(console,e)},t.error=function(...e){e=[n,...e],console.error.apply(console,e)};const n="@gprf"},863:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initialiseCompareCommits=void 0,t.svgPlus=r;const o=n(655),i=n(548);function r(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"height","24"),e.setAttributeNS(null,"width","24"),e.setAttributeNS(null,"viewBox","0 0 512 512"),e.setAttribute("class","hoverable-svg");const t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttributeNS(null,"d","M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM200 344V280H136c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H248v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"),t.setAttributeNS(null,"fill","#737d83"),e.appendChild(t);const n=document.createElement("style");return n.textContent="\n     .hoverable-svg:hover path {\n       fill: #ff87ee;\n     }\n   ",document.head.append(n),e}t.initialiseCompareCommits=()=>{(0,i.log)("initialising 'compare commits'");const e=(0,o.observeValueChange)(null);new MutationObserver((async(t,n)=>{{let e=document.querySelector("#files_bucket .subnav-search"),t=document.querySelector("#files_bucket .subnav-search-icon"),n=document.querySelector("#files_bucket .Layout"),o=document.getElementById("subnav-search-resizer");if(t&&n&&e&&!o){t.style.top="unset",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",o=r(),o.style.margin="8px",o.style.marginRight="0px",o.id="subnav-search-resizer",e.appendChild(o);const i=n.style.getPropertyValue("--Layout-sidebar-width");o.onclick=()=>{if(n){const e=n.style.getPropertyValue("--Layout-sidebar-width");let t="";i===e&&(t="512px"),n.style.setProperty("--Layout-sidebar-width",t)}}}}if(e(window.location.href)&&(0,o.isOnPullRequestConversationTab)()){(0,i.log)("adding commit compare functionality");let e=(0,o.createState)(null);setTimeout((()=>(0,o.addCommitCompareFunctionality)(e)),100)}})).observe(document.body,{childList:!0,subtree:!0})}},888:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateBranchTransitionElement=void 0,t.CreateBranchTransitionElement=e=>{const t=document.createElement("div");return e?(t.textContent="Recognised Transition",t.style.color="var(--borderColor-success-emphasis)",t.style.backgroundColor="var(--bgColor-success-muted)"):(t.textContent="Unknown Transition",t.style.color="var(--bgColor-danger-emphasis)",t.style.backgroundColor="var(--bgColor-danger-muted)"),t.style.display="inline-block",t.style.padding="0 var(--base-size-4)",t.style.font=".85em/1.8 var(--fontStack-monospace, ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace)",t.style.borderRadius="var(--borderRadius-medium)",t}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}(()=>{const e=n(863),t=n(408),o=n(815),i=n(256),r=n(680),s=n(706),a={"feature-who-is-in-the-branch":n(463).initialiseWhoIsInTheBranch,"feature-pull-request-creation":i.initialisePullRequestCreation,"feature-compare-commits":e.initialiseCompareCommits,"feature-files-changed-sidebar-resize":o.initialiseFilesChangedSidebarResize,"feature-pull-request-jira-linking":r.initialisePullRequestJiraLinking,"feature-default-pull-request-filters":t.initialiseDefaultPullRequestFilters,"feature-warn-skip-branch":s.initialiseWarnSkipBranch};chrome.storage.sync.get(Object.keys(a),(e=>{for(const[t,n]of Object.entries(a))console.log(t,e[t]?"disabled":"enabled"),!0!==e[t]&&n()}))})()})();